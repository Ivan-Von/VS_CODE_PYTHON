#重复g高斯勒让德法则
import numpy as np
import math
import sympy
def gauss_legendre(samp,wt):
    nsp=samp.shape[0]
    ndim=samp.shape[1]
    if ndim==1:
        if nsp==1:
            samp[0,0]=  0.0 
            wt[0]  =    2.0 
        elif nsp==2:
            samp[0,0]= -0.57735026918962576449 
            samp[1,0]=  0.57735026918962576449 
            wt[0]=      1.0 
            wt[1]=      1.0 
        elif nsp==3:
            samp[0,0]= -0.77459666924148337704 
            samp[1,0]=  0.0 
            samp[2,0]=  0.77459666924148337704 
            wt[0]=      0.55555555555555555556 
            wt[1]=      0.88888888888888888889 
            wt[2]=      0.55555555555555555556 
        elif nsp==4:
            samp[0,0]= -0.86113631159405257524 
            samp[1,0]= -0.33998104358485626481 
            samp[2,0]=  0.33998104358485626481 
            samp[3,0]=  0.86113631159405257524 
            wt[0]=      0.34785484513745385737 
            wt[1]=      0.65214515486254614271 
            wt[2]=      0.65214515486254614271 
            wt[3]=      0.34785484513745385737 
        elif nsp==5:
            samp[0,0]= -0.90617984593866399282 
            samp[1,0]= -0.53846931010568309105 
            samp[2,0]=  0.0 
            samp[3,0]=  0.53846931010568309105 
            samp[4,0]=  0.90617984593866399282 
            wt[0]=      0.23692688505618908751 
            wt[1]=      0.47862867049936646804 
            wt[2]=      0.56888888888888888889 
            wt[3]=      0.47862867049936646804 
            wt[4]=      0.23692688505618908751    
        else:
            print('积分点数量错误')
    elif ndim==2:
        if nsp==1:
            samp[0,0]=  0.0  
            samp[0,1]=  0.0 
            wt[0]=      4.0 
        elif nsp==4:
            samp[0,0]= -0.57735026918962576449 
            samp[1,0]=  0.57735026918962576449 
            samp[2,0]= -0.57735026918962576449 
            samp[3,0]=  0.57735026918962576449 
            samp[0,1]= -0.57735026918962576449 
            samp[1,1]= -0.57735026918962576449 
            samp[2,1]=  0.57735026918962576449 
            samp[3,1]=  0.57735026918962576449 
            wt[0]=      1.0 
            wt[1]=      1.0 
            wt[2]=      1.0 
            wt[3]=      1.0 
        elif nsp==9:
            samp[0,0]= -0.77459666924148337704 
            samp[1,0]=  0.0 
            samp[2,0]=  0.77459666924148337704 
            samp[3,0]= -0.77459666924148337704 
            samp[4,0]=  0.0 
            samp[5,0]=  0.77459666924148337704 
            samp[6,0]= -0.77459666924148337704 
            samp[7,0]=  0.0 
            samp[8,0]=  0.77459666924148337704 
            samp[0,1]= -0.77459666924148337704 
            samp[1,1]= -0.77459666924148337704 
            samp[2,1]= -0.77459666924148337704 
            samp[3,1]=  0.0 
            samp[4,1]=  0.0 
            samp[5,1]=  0.0 
            samp[6,1]=  0.77459666924148337704 
            samp[7,1]=  0.77459666924148337704 
            samp[8,1]=  0.77459666924148337704 
            wt[0] =     0.30864197530864197531 
            wt[1] =     0.49382716049382716049 
            wt[2] =     0.30864197530864197531 
            wt[3] =     0.49382716049382716049 
            wt[4] =     0.79012345679012345679 
            wt[5] =     0.49382716049382716049 
            wt[6] =     0.30864197530864197531 
            wt[7] =     0.49382716049382716049 
            wt[8] =     0.30864197530864197531 
        elif nsp==16:
            samp[0,0] =-0.86113631159405257524 
            samp[1,0] =-0.33998104358485626481 
            samp[2,0] = 0.33998104358485626481 
            samp[3,0] = 0.86113631159405257524 
            samp[4,0] =-0.86113631159405257524 
            samp[5,0] =-0.33998104358485626481 
            samp[6,0] = 0.33998104358485626481 
            samp[7,0] = 0.86113631159405257524 
            samp[8,0] =-0.86113631159405257524 
            samp[9,0]=-0.33998104358485626481 
            samp[10,0]= 0.33998104358485626481 
            samp[11,0]= 0.86113631159405257524 
            samp[12,0]=-0.86113631159405257524 
            samp[13,0]=-0.33998104358485626481 
            samp[14,0]= 0.33998104358485626481 
            samp[15,0]= 0.86113631159405257524 
            samp[0,1] =-0.86113631159405257524 
            samp[1,1] =-0.86113631159405257524 
            samp[2,1] =-0.86113631159405257524 
            samp[3,1] =-0.86113631159405257524 
            samp[4,1] =-0.33998104358485626481 
            samp[5,1] =-0.33998104358485626481 
            samp[6,1] =-0.33998104358485626481 
            samp[7,1] =-0.33998104358485626481 
            samp[8,1] = 0.33998104358485626481 
            samp[9,1]= 0.33998104358485626481 
            samp[10,1]= 0.33998104358485626481 
            samp[11,1]= 0.33998104358485626481 
            samp[12,1]= 0.86113631159405257524 
            samp[13,1]= 0.86113631159405257524 
            samp[14,1]= 0.86113631159405257524 
            samp[15,1]= 0.86113631159405257524 
            wt[0]=      0.12100299328560200551 
            wt[1]=      0.22685185185185185185 
            wt[2]=      0.22685185185185185185 
            wt[3]=      0.12100299328560200551 
            wt[4]=      0.22685185185185185185 
            wt[5]=      0.42529330301069429082 
            wt[6]=      0.42529330301069429082 
            wt[7]=      0.22685185185185185185 
            wt[8]=      0.22685185185185185185 
            wt[9]=     0.42529330301069429082 
            wt[10]=     0.42529330301069429082 
            wt[11]=     0.22685185185185185185 
            wt[12]=     0.12100299328560200551 
            wt[13]=     0.22685185185185185185 
            wt[14]=     0.22685185185185185185 
            wt[15]=     0.12100299328560200551 
        elif nsp==25:
            samp[0,0] =-0.90617984593866399282 
            samp[1,0] =-0.53846931010568309105 
            samp[2,0] = 0.0 
            samp[3,0] = 0.53846931010568309105 
            samp[4,0] = 0.90617984593866399282 
            samp[5,0] =-0.90617984593866399282 
            samp[6,0] =-0.53846931010568309105 
            samp[7,0] = 0.0 
            samp[8,0] = 0.53846931010568309105 
            samp[9,0]= 0.90617984593866399282 
            samp[10,0]=-0.90617984593866399282 
            samp[11,0]=-0.53846931010568309105 
            samp[12,0]= 0.0 
            samp[13,0]= 0.53846931010568309105 
            samp[14,0]= 0.90617984593866399282 
            samp[15,0]=-0.90617984593866399282 
            samp[16,0]=-0.53846931010568309105 
            samp[17,0]= 0.0 
            samp[18,0]= 0.53846931010568309105 
            samp[19,0]= 0.90617984593866399282 
            samp[20,0]=-0.90617984593866399282 
            samp[21,0]=-0.53846931010568309105 
            samp[22,0]= 0.0 
            samp[23,0]= 0.53846931010568309105 
            samp[24,0]= 0.90617984593866399282 
            samp[0,1] =-0.90617984593866399282 
            samp[1,1] =-0.90617984593866399282 
            samp[2,1] =-0.90617984593866399282 
            samp[3,1] =-0.90617984593866399282 
            samp[4,1] =-0.90617984593866399282 
            samp[5,1] =-0.53846931010568309105 
            samp[6,1] =-0.53846931010568309105 
            samp[7,1] =-0.53846931010568309105 
            samp[8,1] =-0.53846931010568309105 
            samp[9,1]=-0.53846931010568309105 
            samp[10,1]= 0.0 
            samp[11,1]= 0.0 
            samp[12,1]= 0.0 
            samp[13,1]= 0.0 
            samp[14,1]= 0.0 
            samp[15,1]= 0.53846931010568309105 
            samp[16,1]= 0.53846931010568309105 
            samp[17,1]= 0.53846931010568309105 
            samp[18,1]= 0.53846931010568309105 
            samp[19,1]= 0.53846931010568309105 
            samp[20,1]= 0.90617984593866399282 
            samp[21,1]= 0.90617984593866399282 
            samp[22,1]= 0.90617984593866399282 
            samp[23,1]= 0.90617984593866399282 
            samp[24,1]= 0.90617984593866399282 
            wt[0] =     0.05613434886242863595 
            wt[1] =     0.1134 
            wt[2] =     0.13478507238752090312 
            wt[3] =     0.1134 
            wt[4] =     0.05613434886242863595 
            wt[5] =     0.1134 
            wt[6] =     0.22908540422399111713 
            wt[7] =     0.27228653255075070182 
            wt[8] =     0.22908540422399111713 
            wt[9]=     0.1134 
            wt[10]=     0.13478507238752090305  
            wt[11]=     0.27228653255075070171  
            wt[12]=     0.32363456790123456757  
            wt[13]=     0.27228653255075070171  
            wt[14]=     0.13478507238752090305  
            wt[15]=     0.1134 
            wt[16]=     0.22908540422399111713 
            wt[17]=     0.27228653255075070182 
            wt[18]=     0.22908540422399111713 
            wt[19]=     0.1134 
            wt[20]=     0.05613434886242863595 
            wt[21]=     0.1134 
            wt[22]=     0.13478507238752090312 
            wt[23]=     0.1134 
            wt[24]=     0.05613434886242863595 
        else:
            print('积分点数量错误')
    elif ndim==3:
        if nsp==1:
            samp[0,0]=  0.0  
            samp[0,1]=  0.0 
            samp[0,2]=  0.0 
            wt[0]=      8.0 
        elif nsp==8:
            samp[0,0]=-0.57735026918962576449 
            samp[1,0]= 0.57735026918962576449 
            samp[2,0]=-0.57735026918962576449 
            samp[3,0]= 0.57735026918962576449 
            samp[4,0]=-0.57735026918962576449 
            samp[5,0]= 0.57735026918962576449 
            samp[6,0]=-0.57735026918962576449 
            samp[7,0]= 0.57735026918962576449 
            samp[0,1]=-0.57735026918962576449 
            samp[1,1]=-0.57735026918962576449 
            samp[2,1]=-0.57735026918962576449 
            samp[3,1]=-0.57735026918962576449 
            samp[4,1]= 0.57735026918962576449 
            samp[5,1]= 0.57735026918962576449 
            samp[6,1]= 0.57735026918962576449 
            samp[7,1]= 0.57735026918962576449 
            samp[0,2]=-0.57735026918962576449 
            samp[1,2]=-0.57735026918962576449 
            samp[2,2]= 0.57735026918962576449 
            samp[3,2]= 0.57735026918962576449 
            samp[4,2]=-0.57735026918962576449 
            samp[5,2]=-0.57735026918962576449 
            samp[6,2]= 0.57735026918962576449 
            samp[7,2]= 0.57735026918962576449 
            wt[0]=     1.0                                          
            wt[1]=     1.0                                          
            wt[2]=     1.0                                          
            wt[3]=     1.0                                          
            wt[4]=     1.0                                          
            wt[5]=     1.0                                          
            wt[6]=     1.0                                          
            wt[7]=     1.0                                          
        elif nsp==27:
            samp[0,0]= -0.77459666924148337704 
            samp[1,0]=  0.0 
            samp[2,0]=  0.77459666924148337704 
            samp[3,0]= -0.77459666924148337704 
            samp[4,0]=  0.0 
            samp[5,0]=  0.77459666924148337704 
            samp[6,0]= -0.77459666924148337704 
            samp[7,0]=  0.0 
            samp[8,0]=  0.77459666924148337704 
            samp[9,0]=-0.77459666924148337704 
            samp[10,0]= 0.0 
            samp[11,0]= 0.77459666924148337704 
            samp[12,0]=-0.77459666924148337704 
            samp[13,0]= 0.0 
            samp[14,0]= 0.77459666924148337704 
            samp[15,0]=-0.77459666924148337704 
            samp[16,0]= 0.0 
            samp[17,0]= 0.77459666924148337704 
            samp[18,0]=-0.77459666924148337704 
            samp[19,0]= 0.0 
            samp[20,0]= 0.77459666924148337704 
            samp[21,0]=-0.77459666924148337704 
            samp[22,0]= 0.0 
            samp[23,0]= 0.77459666924148337704 
            samp[24,0]=-0.77459666924148337704 
            samp[25,0]= 0.0 
            samp[26,0]= 0.77459666924148337704 
            samp[0,1]= -0.77459666924148337704 
            samp[1,1]= -0.77459666924148337704 
            samp[2,1]= -0.77459666924148337704 
            samp[3,1]= -0.77459666924148337704 
            samp[4,1]= -0.77459666924148337704 
            samp[5,1]= -0.77459666924148337704 
            samp[6,1]= -0.77459666924148337704 
            samp[7,1]= -0.77459666924148337704 
            samp[8,1]= -0.77459666924148337704 
            samp[9,1]= 0.0 
            samp[10,1]= 0.0 
            samp[11,1]= 0.0 
            samp[12,1]= 0.0 
            samp[13,1]= 0.0 
            samp[14,1]= 0.0 
            samp[15,1]= 0.0 
            samp[16,1]= 0.0 
            samp[17,1]= 0.0 
            samp[18,1]= 0.77459666924148337704 
            samp[19,1]= 0.77459666924148337704 
            samp[20,1]= 0.77459666924148337704 
            samp[21,1]= 0.77459666924148337704 
            samp[22,1]= 0.77459666924148337704 
            samp[23,1]= 0.77459666924148337704 
            samp[24,1]= 0.77459666924148337704 
            samp[25,1]= 0.77459666924148337704 
            samp[26,1]= 0.77459666924148337704 
            samp[0,2]= -0.77459666924148337704 
            samp[1,2]= -0.77459666924148337704 
            samp[2,2]= -0.77459666924148337704 
            samp[3,2]=  0.0 
            samp[4,2]=  0.0 
            samp[5,2]=  0.0 
            samp[6,2]=  0.77459666924148337704 
            samp[7,2]=  0.77459666924148337704 
            samp[8,2]=  0.77459666924148337704 
            samp[9,2]=-0.77459666924148337704 
            samp[10,2]=-0.77459666924148337704 
            samp[11,2]=-0.77459666924148337704 
            samp[12,2]= 0.0 
            samp[13,2]= 0.0 
            samp[14,2]= 0.0 
            samp[15,2]= 0.77459666924148337704 
            samp[16,2]= 0.77459666924148337704 
            samp[17,2]= 0.77459666924148337704 
            samp[18,2]=-0.77459666924148337704 
            samp[19,2]=-0.77459666924148337704 
            samp[20,2]=-0.77459666924148337704 
            samp[21,2]= 0.0 
            samp[22,2]= 0.0 
            samp[23,2]= 0.0 
            samp[24,2]= 0.77459666924148337704 
            samp[25,2]= 0.77459666924148337704 
            samp[26,2]= 0.77459666924148337704 
            wt[0]     = 0.17146776406035665295 
            wt[1]     = 0.27434842249657064472 
            wt[2]     = 0.17146776406035665295 
            wt[3]     = 0.27434842249657064472 
            wt[4]     = 0.43895747599451303155 
            wt[5]     = 0.27434842249657064472 
            wt[6]     = 0.17146776406035665295 
            wt[7]     = 0.27434842249657064472 
            wt[8]     = 0.17146776406035665295 
            wt[9]    = 0.27434842249657064472 
            wt[10]    = 0.43895747599451303155 
            wt[11]    = 0.27434842249657064472 
            wt[12]    = 0.43895747599451303155 
            wt[13]    = 0.70233196159122085048 
            wt[14]    = 0.43895747599451303155 
            wt[15]    = 0.27434842249657064472 
            wt[16]    = 0.43895747599451303155 
            wt[17]    = 0.27434842249657064472 
            wt[18]    = 0.17146776406035665295 
            wt[19]    = 0.27434842249657064472 
            wt[20]    = 0.17146776406035665295 
            wt[21]    = 0.27434842249657064472 
            wt[22]    = 0.43895747599451303155 
            wt[23]    = 0.27434842249657064472 
            wt[24]    = 0.17146776406035665295 
            wt[25]    = 0.27434842249657064472 
            wt[26]    = 0.17146776406035665295 
        else:
            print('积分点数量错误')
    else:
        print('维度不合理')



a=0
b=1
nsp=10
nr=25
samp=np.zeros((nsp,1))
wt=np.zeros((nsp))
gauss_legendre(samp,wt)
wr=(b-a)/nr
hr=0.5*wr
area=0
def f62(x):
    return (x*sympy.exp(x))/((1+x) ** 2)
for i in range(1,nr+1):
    cr=a+(i-1)*wr+hr
    for j in range(1,nsp+1):
        area=area+wt[j-1]*hr*f62(cr+samp[j-1,0]*hr)
print('重复高斯勒让德法则')
print('积分上下限',a,b)
print('牛顿柯特法则的样本点个数',nsp)
print('重复小区间个数',nr)
print('计算结果',area)

